| **DNS Issue**                          | **Description / Symptom**                                                | **Likely Cause**                                           | **Expected / Correct Behavior**                                            | **Fix / Remediation**                                                                                |
| -------------------------------------- | ------------------------------------------------------------------------ | ---------------------------------------------------------- | -------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- |
| **Incorrect DNS Resolution Path**      | Client queries go to wrong DNS (e.g., local ISP DNS instead of SASE DNS) | Misconfigured ZTNA/SWG policy or split tunnel rules        | All DNS queries should go through SASE resolver unless explicitly bypassed | Ensure DNS traffic (port 53/853) is forced through Harmony client tunnel; update split tunnel policy |
| **DNS Leak**                           | DNS requests bypass SASE and go directly to external resolvers           | Split tunnel incorrectly includes DNS                      | All DNS queries should resolve via SASE enforcement point                  | Adjust split tunnel config to exclude DNS from bypass list                                           |
| **Internal Domain Resolution Failure** | Corporate internal domains (e.g., \*.corp.local) not resolving           | Internal DNS not reachable through tunnel                  | Internal DNS server should be accessible over ZTNA                         | Add DNS server IPs to internal routes; ensure they’re in allowed traffic policy                      |
| **Slow DNS Resolution**                | High latency when resolving external domains                             | DNS server location far from client or overloaded          | DNS resolution should be <100ms                                            | Use geographically closer SASE DNS nodes; enable DNS cache in Harmony                                |
| **Office 365 Resolution Delay**        | O365 services slow to load despite network being fine                    | O365 traffic not optimized in SASE                         | O365 should resolve via Microsoft DNS edge                                 | Add O365 FQDNs to “Office 365 Optimization” in Harmony policy                                        |
| **Blocked DNS Queries**                | DNS queries fail entirely                                                | SASE security policy or firewall rule blocking port 53/853 | DNS should be allowed to SASE resolver                                     | Allow DNS in Access Policy; ensure DNS over HTTPS (DoH) if required                                  |
| **DNS over HTTPS Failure**             | DoH clients (e.g., browsers) fail to resolve                             | Harmony blocks or intercepts DoH                           | DoH should either work via policy or be redirected                         | Configure Harmony to allow or transparently proxy DoH                                                |
| **DNS Loop**                           | Continuous retry of DNS queries                                          | Misconfigured DNS forwarders in SASE gateway               | DNS should resolve without recursion loop                                  | Correct forwarder configuration in Harmony DNS settings                                              |
| **VPN/SASE Disconnects due to DNS**    | Tunnel drops when DNS fails                                              | SASE requires DNS to maintain control channel              | DNS resolution should always be available to SASE POP                      | Add SASE DNS IPs to “Always Allowed” list in client config                                           |


#### Harmony SASE DNS Troubleshooting Flowchart

<img width="411" height="1133" alt="image" src="https://github.com/user-attachments/assets/c313b3f8-7eb7-4fd0-9482-f5587e533a2f" />

